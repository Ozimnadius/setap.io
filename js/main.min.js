//@prepros-append pages/common.js
//@prepros-append pages/maps.js
//@prepros-append pages/header.js
//@prepros-append pages/sliders.js
//@prepros-append pages/index.js
//@prepros-append pages/uslugi.js
//@prepros-append pages/to.js

// common.js
function Switches(prop) {
    this.sws = document.querySelector(prop.sws);
    this.swsList = document.querySelectorAll(prop.sw);
    this.tabs = document.querySelectorAll(prop.tab);
    this.tabSelector = prop.tab;
    this.tabsContainer = document.querySelector(prop.tabsContainer);

    let that = this;

    this.init = function () {
        let $this = that.swsList[0],
            id = $this.dataset.id,
            maxH = 0,
            tab = document.querySelector(that.tabSelector + '[data-id="' + id + '"]');


        for (let i = 0; i < that.swsList.length; i++) {
            that.swsList[i].classList.remove('active');
        }

        for (let i = 0; i < that.tabs.length; i++) {
            that.tabs[i].classList.remove('active');
            let height =  that.tabs[i].offsetHeight;

            if (maxH<height) {
                maxH = height;
            }
        }

        tab.classList.add('active');
        $this.classList.add('active');
        that.tabsContainer.style.height = maxH+'px';

    };

    for (let i = 0; i < that.swsList.length; i++) {
        that.swsList[i].addEventListener('click', function (e) {

            let percent = (this.offsetLeft / that.width) * 100,
                id = this.dataset.id,
                tab = document.querySelector(that.tabSelector + '[data-id="' + id + '"]');


            for (let i = 0; i < that.swsList.length; i++) {
                that.swsList[i].classList.remove('active');
            }

            for (let i = 0; i < that.tabs.length; i++) {
                that.tabs[i].classList.remove('active');
            }

            tab.classList.add('active');
            this.classList.add('active');

        });
    }
}

$('input[type=tel]').mask('+7 (999) 999-99-99');
/*YANDEX*/
$(function ()   {
    ymaps.ready(init);
    var myMap,
        myPlacemark;

    function init() {

        if ($('#map').length) {
            var center = [55.833849568909045,37.29893099999997];
            // if ($(window).width() < 576) {
            //     center = [55.609501798660396, 37.61325538360591];
            // }

            myMap = new ymaps.Map("map", {
                center: center,
                zoom: 16,
                controls: []
            });


            myMap.behaviors.disable(['scrollZoom']);

            myPin = new ymaps.GeoObjectCollection({}, {});


            myPlacemark1 = new ymaps.Placemark([55.833849568909045,37.29893099999997], {
                    balloonContentHeader: "Inthestore",
                    balloonContentBody: "Inthestore",
                    balloonContentFooter: "Московская область,  г. Красногорск, ул. Ленина, д. 38-б, офис 88",
                    hintContent: "Inthestore.ru"
                },
                {

                    preset: 'islands#violetDotIcon'
                });


            myPin.add(myPlacemark1);
            myMap.geoObjects.add(myPin);
        }
    }
});
/*END YANDEX*/

// slider.js
$(function () {
    let slider = new Swiper ('.slider__container', {
        loop: true,
        navigation: {
            nextEl: '.slider__next',
            prevEl: '.slider__prev',
        },
        pagination: {
            el: '.slider__pag',
            clickable: true
        }
    });



});
//index.js
$(function () {

    let maxH = 0,
        icatsTitle = $('.icat__title');

    icatsTitle.each(function (x, i) {
        let height = $(i).outerHeight();

        if (maxH < height) {
            maxH = height;
        }
    });

    icatsTitle.css('height', maxH);

    if (document.querySelector('.sols__sws')) {
        let subSwitches = new Switches({
            sws: '.sols__sws',
            sw: '.sols__sw',
            tab: '.sols__tab',
            tabsContainer: '.sols__tabs'
        }).init();
    }
    if (document.querySelector('.iready__sws')) {
        let switches = new Switches({
            sws: '.iready__sws',
            sw: '.iready__sw',
            tab: '.iready__tab',
            tabsContainer: '.iready__tabs'
        }).init();
    }

    let quiz = new Swiper('.quiz__container', {
        effect: 'cube',
        speed: 1500,
        allowTouchMove: false,
        cubeEffect: {
            shadow: false,
        },
        on: {
            slideChange: function (e) {
                // console.log(this);
                let counter = this.slides.length,
                    i = this.activeIndex + 1,
                    slide = $(this.slides[this.activeIndex]),
                    scrollbar = slide.find('.quiz__scrollbar'),
                    scrollbarLine = scrollbar.find('.quiz__scrollbar-line'),
                    width = '';

                width = ((100 / counter) * i) + '%'
                scrollbarLine.css('width', width);

            }
        }
    });

    $('.quiz__form').validate(
        {
            rules: {
                quizName: "required",
                quizEmail: "required"
            },
            messages: {
                quizName: "Необходимо указать Ваше имя",
                quizEmail: "Неправильно указан адрес электронной почты"
            },
            submitHandler: function (form) {
                //ToDo здесь должен быть ajax, при успешной отправке данных перелистывается на следующий слайд
                quiz.slideNext();
            },
        }
    );

    $('.jsQuizNext').on('click', function (e) {
        quiz.slideNext();
    });

    $('.ichart__item-after').each(function (x, i) {

        let item = $(i),
            parent = item.closest('.ichart__item'),
            height = parent.outerHeight() - 33,
            arr = parent.find('.ichart__item-arr'),
            line = parent.find('.ichart__line'),
            bottomLine = parent.find('.ichart__item-before');

        if (x == 0) {
            $('.ichart__list').css({
                // paddingRight: (height/2)+'px'
            });
        }

        item.css({
            height: height + 'px',
            width: height + 'px',
            // left: 'calc(100% - '+(height/2)+'px)'
        });
        line.css({
            marginRight: (height / 2) + 'px'
        });
        arr.css({
            right: (height / 2) + 'px'
        });
        bottomLine.css({
            right: (height / 2) + 'px'
        });

    });

    $('.feed__form').validate(
        {
            rules: {
                name: "required",
                tel: "required"
            },
            messages: {
                name: "Укажите Ваше имя",
                tel: "Укажите Ваш телефон"
            },
            submitHandler: function (form) {
                //ToDo здесь должен быть ajax, при успешной отправке данных появляется всплывающее окно с результатом
            },
            errorPlacement: function (error, element) {
                element[0].placeholder = error[0].innerText;
            }
        }
    );

    $('.count__up').on('click', function (e) {

        let $this = $(this),
            count = $this.closest('.count'),
            inputObj = count.find('.count__input'),
            val = inputObj.val();
        val++;
        inputObj.val(val);
    });
    $('.count__down').on('click', function (e) {
        let $this = $(this),
            count = $this.closest('.count'),
            inputObj = count.find('.count__input'),
            val = inputObj.val();

        val--;
        if (val>=0){
            inputObj.val(val);
        }
    });


});
//index.js
$(function () {

    let maxH = 0,
        uslugiTitle = $('.uslugi__item-title');

    uslugiTitle.each(function (x, i) {
        let height = $(i).outerHeight();

        if (maxH < height) {
            maxH = height;
        }
    });

    uslugiTitle.css('height', maxH);
});
//to.js
$(function () {

    if (document.querySelector('.to__sws')) {
        let subSwitches = new Switches({
            sws: '.to__sws',
            sw: '.to__sw',
            tab: '.to__tab',
            tabsContainer: '.to__tabs'
        }).init();
    }
});

//# sourceMappingURL=main.min.js.map